- id: allow-ssh-from-anywhere
  description: Permet SSH depuis n'importe où
  criterias:
    and:
      - field: name
        operator: contains
        value: "SSH"
      - field: local_ports
        operator: in_range
        value: [22, 22]
      - field: protocol
        operator: equals
        value: "TCP"
      - field: remote_addresses
        operator: contains
        value: "0.0.0.0/0"
      - field: action
        operator: equals
        value: "ALLOW"
  severity: high

- id: block-rule-without-app
  description: Règle qui bloque du trafic sans être liée à une application
  criterias:
    and:
      - field: action
        operator: equals
        value: "BLOCK"
      - field: application_name
        operator: is_null
  severity: medium

- id: open-web-from-anywhere
  description: Permet HTTP/HTTPS ouvert à tous
  criterias:
    and:
      - field: local_ports
        operator: in_range
        value: [80, 443]
      - field: protocol
        operator: equals
        value: "TCP"
      - field: remote_addresses
        operator: contains
        value: "0.0.0.0/0"
      - field: action
        operator: equals
        value: "ALLOW"
  severity: high

- id: allow-rdp-from-specific-ip
  description: Permet RDP (port 3389) depuis IP spécifique
  criterias:
    and:
      - field: local_ports
        operator: in_range
        value: [3389, 3389]
      - field: protocol
        operator: equals
        value: "TCP"
      - field: remote_addresses
        operator: contains
        value: "192.168.1.100"
      - field: action
        operator: equals
        value: "ALLOW"
  severity: low

- id: allow-any-rule-without-app
  description: Toute règle ALLOW sans application
  criterias:
    and:
      - field: action
        operator: equals
        value: "ALLOW"
      - field: application_name
        operator: is_null
  severity: info

- id: check-inbound-enabled-allow
  description: Vérifie les règles entrantes actives qui autorisent le trafic
  criterias:
    and:
      - field: direction
        operator: equals
        value: "Inbound"
      - field: enabled
        operator: equals
        value: true
      - field: action
        operator: equals
        value: "Allow"
  severity: high

- id: check-description-contains
  description: Vérifie que la description contient 'Windows'
  criterias:
    and:
      - field: description
        operator: contains
        value: "Windows"
  severity: info

- id: check-application-name-null
  description: Vérifie les règles sans application associée
  criterias:
    and:
      - field: application_name
        operator: is_null
  severity: medium

- id: check-service-name-matches
  description: Vérifie les règles pour le service 'wuauserv' ou 'Dhcp'
  criterias:
    and:
      - field: service_name
        operator: matches
        value: ["wuauserv", "Dhcp"]
  severity: info

- id: check-protocol-tcp
  description: Vérifie les règles TCP
  criterias:
    and:
      - field: protocol
        operator: equals
        value: "Tcp"
  severity: info

- id: check-local-ports-80-443
  description: Vérifie les règles sur les ports 80 ou 443
  criterias:
    and:
      - field: local_ports
        operator: matches
        value: [80, 443]
  severity: high

- id: check-local-ports-range
  description: Vérifie les règles sur la plage de ports 20 à 25
  criterias:
    and:
      - field: local_ports
        operator: in_range
        value: [20, 25]
  severity: info

- id: check-remote-ports-53
  description: Vérifie les règles sur le port distant 53
  criterias:
    and:
      - field: remote_ports
        operator: matches
        value: 53
  severity: info

- id: check-local-addresses-loopback
  description: Vérifie les règles sur l'adresse locale 127.0.0.1
  criterias:
    and:
      - field: local_addresses
        operator: contains
        value: "127.0.0.1"
  severity: info

- id: check-remote-addresses-any
  description: Vérifie les règles qui s'appliquent à toutes les adresses distantes
  criterias:
    and:
      - field: remote_addresses
        operator: contains
        value: "0.0.0.0/0"
  severity: info

- id: check-icmp-types
  description: Vérifie les règles ICMP
  criterias:
    and:
      - field: icmp_types_and_codes
        operator: contains
        value: "8"
  severity: info

- id: check-interfaces-wifi
  description: Vérifie les règles sur l'interface Wi-Fi
  criterias:
    and:
      - field: interfaces
        operator: contains
        value: "Wi-Fi"
  severity: info

- id: check-interface-types-lan
  description: Vérifie les règles sur le type d'interface LAN
  criterias:
    and:
      - field: interface_types
        operator: contains
        value: "Lan"
  severity: info

- id: check-grouping-sharing
  description: Vérifie les règles du groupe 'File and Printer Sharing'
  criterias:
    and:
      - field: grouping
        operator: contains
        value: "File and Printer Sharing"
  severity: info

- id: check-profiles-domain
  description: Vérifie les règles associées au profil Domain
  criterias:
    and:
      - field: profiles
        operator: contains
        value: "Domain"
  severity: info

- id: check-edge-traversal-enabled
  description: Vérifie les règles avec edge traversal activé
  criterias:
    and:
      - field: edge_traversal
        operator: equals
        value: true
  severity: info

- id: not-allow
  description: Règles qui ne sont pas en Allow
  criterias:
    not:
      field: action
      operator: equals
      value: "Allow"
  severity: high

- id: regex-rule
  description: Règles dont le nom commence par SSH (regex)
  criterias:
    and:
      - field: name
        operator: regex
        value: "^SSH.*"
  severity: info

- id: port-gt-1024
  description: Ports locaux > 1024
  criterias:
    and:
      - field: local_ports
        operator: gt
        value: 1024
  severity: info

- id: port-lte-1024
  description: Ports locaux <= 1024
  criterias:
    and:
      - field: local_ports
        operator: lte
        value: 1024
  severity: info

- id: ip-cidr
  description: Règles sur le sous-réseau 192.168.0.0/16
  criterias:
    and:
      - field: remote_addresses
        operator: cidr
        value: "192.168.0.0/16"
  severity: info

- id: wildcard-rule
  description: Règles dont le nom contient 'RDP*'
  criterias:
    and:
      - field: name
        operator: wildcard
        value: "RDP*"
  severity: info 